function [MCNP] = SSS_WORPH_Burnup(fileID,MCNP)

%build the burn up list
Burnspecs.Mat_NumberUnique=MCNP.FuelCell{1}.Fuel.Mat_NumberUnique;
Burnspecs.Mat_Areas=MCNP.FuelCell{1}.Fuel.Mat_Areas;

%% print stuff
if 1< length(MCNP.FuelCell)
for kkk = 2:length(MCNP.FuelCell)    
Burnspecs.Mat_NumberUnique=[Burnspecs.Mat_NumberUnique MCNP.FuelCell{kkk}.Fuel.Mat_NumberUnique];
Burnspecs.Mat_Areas=[Burnspecs.Mat_Areas MCNP.FuelCell{kkk}.Fuel.Mat_Areas];
end
end

fuel_vol_total=sum(Burnspecs.Mat_Areas)*20;

if ~strcmp(MCNP.Burnup.Option,'none') || ~strcmp(MCNP.Burnup.Option,'None');

 
    Inf_power=MCNP.Burnup.Power_Desnity*fuel_vol_total/1000;
 
   
   MCNP.Burnup.String = ...
            [' %% --- Decay and fission yield library \n' ...
            'set declib "/panfs/pan2/scratch1/eademich/xsdata/sss_endfb7.dec" \n' ...
            'set nfylib "/panfs/pan2/scratch1/eademich/xsdata/sss_endfb7.nfy" \n' ...
            '%% --- Cut-offs \n' ...
            'set fpcut   1.0E-10 \n' ...
            'set stabcut 1.0E-10 \n' ...
            '%% --- set q values \n' ...
            ' set U235H 195.19 \n' ...
            '%% --- Option for burnup calculation \n' ...
            'set bumode    2 \n' ...
            'set pcc       3 \n' ...
            'set printm    1 \n' ...
            '%% ----shuffling\n' ...
            'set power ', num2str(Inf_power*10^6), ' \n' ... 
            'dep daystep\n' ... 
            '0.0086805556 0.0086805556 \n'...
            'set power 0 \n' ... 
            'dep daystep\n' ... 
            '0.052083333 0.052083333 0.052083333 0.052083333 0.052083333 \n'...
            'set power ', num2str(Inf_power*10^6), ' \n' ... 
            'dep daystep\n' ... 
            '0.0086805556 0.0086805556 \n' ...
            'set power 0 \n' ... 
            'dep daystep\n', ... 
            '40 40 40 40 40 \n' ...
            'set power ', num2str(Inf_power*10^6), ' \n' ... 
            'dep daystep\n' ... 
            '0.0041666667 0.0041666667 \n' ... 
            'set power 0 \n' ... 
            'dep daystep\n' ... 
            '71.42857143 71.42857143 71.42857143 71.42857143 71.42857143 \n' ...
            'set power ', num2str(Inf_power*10^6), ' \n' ... 
            'dep daystep\n', ... 
            '0.0031250000 0.0031250000 \n' ...
            '%% ---- Nuclide inventory \n' ...
            'set inventory all \n'];
   
     
end


end

