function  [MCNP]  = Out_Metal_Mat(MCNP)
if isfield(MCNP.Material.normal.Out_Metal,'Poison_Frac')
Poison_load = MCNP.Material.normal.Out_Metal.Poison_Frac; % pmm loaded
else
Poison_load=0;
end

if isfield(MCNP.Material.normal.Out_Metal,'Poison_Type')
Poison_Type = MCNP.Material.normal.Out_Metal.Poison_Type;
else 
   Poison_Type=0;
end

startm=0.999999920710000
ppm=Poison_load*10^-6
addm=startm*ppm/(1-ppm)



Gd_Abundances    = [.002;.0218;0.148;0.2047;0.1565;0.2484;0.2186];
Gd_sum           = Gd_Abundances(1)+Gd_Abundances(2) + Gd_Abundances(3) + Gd_Abundances(4) + Gd_Abundances(6) + Gd_Abundances(7);
GD_FW152         = Gd_Abundances(1)/Gd_sum;
GD_FW154         = Gd_Abundances(2)/Gd_sum;
GD_FW155         = Gd_Abundances(3)/Gd_sum;
GD_FW156         = Gd_Abundances(4)/Gd_sum;
GD_FW158         = Gd_Abundances(6)/Gd_sum;
GD_FW160         = Gd_Abundances(7)/Gd_sum;




%% Write fuel composition to file if flaged

TT_Metal=...
       [ '8016.80c -1.196000e-03  \n'...
'24050.80c -4.331965e-05  \n'...
'24052.80c -8.353763e-04  \n'...
'24053.80c -9.472497e-05  \n'...
'24054.80c -2.357905e-05  \n'...
'26054.80c -1.165493e-04  \n'...
'26056.80c -1.829575e-03  \n'...
'26057.80c -4.225286e-05  \n'...
'26058.80c -5.623080e-06  \n'...
'40090.80c -5.051659e-01  \n'...
'40091.80c -1.101645e-01  \n'...
'40092.80c -1.683886e-01  \n'...
'40094.80c -1.706469e-01  \n'...
'40096.80c -2.749202e-02  \n'...
'50112.80c -1.353635e-04  \n'...
'50114.80c -9.210300e-05  \n'...
'50115.80c -4.744700e-05  \n'...
'50116.80c -2.029057e-03  \n'...
'50117.80c -1.071744e-03  \n'...
'50118.80c -3.379901e-03  \n'...
'50119.80c -1.198735e-03  \n'...
'50120.80c -4.546539e-03  \n'...
'50122.80c -6.461165e-04  \n'...
'50124.80c -8.079945e-04\n'];


if Poison_Type == 1; %Gd Natural Composition
    Poison =...
       error('not done');
elseif Poison_Type == 2; % Gd-157 enriched
    Poison =...
       ['64152.80c ',num2str(-addm*GD_FW152*.05,'%18.10e'),' \n',...
        '64154.80c ',num2str(-addm*GD_FW154*.05,'%18.10e'),' \n',...
        '64155.80c ',num2str(-addm*GD_FW155*.05,'%18.10e'),' \n',...
        '64156.80c ',num2str(-addm*GD_FW156*.05,'%18.10e'),' \n',...
        '64157.80c ',num2str(-addm*.95,'%18.10e'),' \n',...
        '64158.80c ',num2str(-addm*GD_FW158*.05,'%18.10e'),' \n',...
        '64160.80c ',num2str(-addm*GD_FW160*.05,'%18.10e'),' \n']  ;
    
elseif Poison_Type == 3; %Hafnium Composition
  error('not done');
    
elseif Poison_Type == 4; %Hf enriched Composition
error('not done');
    
elseif Poison_Type == 5   %Th Natural Composition0
  error('not done');
    
end

% Mt3 Thermal ScatterOutg for UO2

if exist('Poison')
MCNPpre.Material.normal.Out_Metal.Material_String = strcat(TT_Metal,Poison);
else 
MCNPpre.Material.normal.Out_Metal.Material_String =TT_Metal;
end

MCNP=mergestruct(MCNP,MCNPpre);
end





